-- Asignando cuota ilimitada sobre la tabla 

/* Estas dos lineas permiten que tanto el esquema de la tabla como el esquema del 
 * usuario SYS puedan realizar modificaciones sobre las tablas
 */

ALTER USER APP_DATOS_IMPRESION quota unlimited on USERS;

ALTER USER SYS quota unlimited on USERS;

-- Creando tabla estratos

CREATE TABLE APP_DATOS_IMPRESION.STRATUMS (
	ID INTEGER NOT NULL,
	COST_PER_CM FLOAT NOT NULL,
	BUSINESS_DAYS INTEGER NOT NULL,
	CONSTRAINT STRATUMS_PK PRIMARY KEY (ID)
);

-- Creando tabla clientes

CREATE TABLE APP_DATOS_IMPRESION.CLIENTS (
	ID INTEGER GENERATED BY DEFAULT ON NULL AS IDENTITY START WITH 1 INCREMENT BY 1,
	DOCUMENT INTEGER NOT NULL,
	NAME VARCHAR2(100) NOT NULL,
	ADDRESS VARCHAR2(100) NOT NULL,
	STRATUM_ID INTEGER NOT NULL,
	CONSTRAINT CLIENTS_PK PRIMARY KEY (ID),
	CONSTRAINT STRATUM_ID FOREIGN KEY (STRATUM_ID) REFERENCES APP_DATOS_IMPRESION.STRATUMS(ID)
);

-- Creando tabla periodos

CREATE TABLE APP_DATOS_IMPRESION.PERIODS (
	ID INTEGER GENERATED BY DEFAULT ON NULL AS IDENTITY START WITH 1 INCREMENT BY 1,
	MONTH_YEAR VARCHAR2(100) NOT NULL,
	CONSTRAINT PERIOD_PK PRIMARY KEY (ID)
);

-- Creando tabla consumos

CREATE TABLE APP_DATOS_IMPRESION.CONSUMPTIONS (
	ID INTEGER GENERATED BY DEFAULT ON NULL AS IDENTITY START WITH 1 INCREMENT BY 1,
	CUBIC_METERS FLOAT NOT NULL,
	CLIENT_ID INTEGER NOT NULL,
	PERIOD_ID INTEGER NOT NULL,
	CONSTRAINT CONSUMPTIONS_PK PRIMARY KEY (ID),
	CONSTRAINT FK_CLIENTS FOREIGN KEY (CLIENT_ID) REFERENCES APP_DATOS_IMPRESION.CLIENTS(ID),
	CONSTRAINT FK_PERIODS FOREIGN KEY (PERIOD_ID) REFERENCES APP_DATOS_IMPRESION.PERIODS(ID)
);

-- Creando tabla facturas

CREATE TABLE APP_DATOS_IMPRESION.BILLS (
	ID INTEGER GENERATED BY DEFAULT ON NULL AS IDENTITY START WITH 1 INCREMENT BY 1,
	PAYMENT_DUE DATE NOT NULL,
	AMOUNT FLOAT NOT NULL,
	DELIVERY_RATE FLOAT NOT NULL,
	CONSUMPTION_ID INTEGER NOT NULL,
	CONSTRAINT BILLS_PK PRIMARY KEY (ID),
	CONSTRAINT FK_CONSUMPTIONS FOREIGN KEY (CONSUMPTION_ID) REFERENCES APP_DATOS_IMPRESION.CONSUMPTIONS(ID)
);

-- Creando tabla que guarda inf sobre los archivos .CSV con el print spool

CREATE TABLE APP_DATOS_IMPRESION.PRINTSPOOLS (
	ID INTEGER GENERATED BY DEFAULT ON NULL AS IDENTITY START WITH 1 INCREMENT BY 1,
	PERIOD_ID INTEGER NOT NULL,
	LINK VARCHAR2(100) NOT NULL,
	CREATED VARCHAR2(100) NOT NULL,
	CONSTRAINT PRINTSPOOLS_PK PRIMARY KEY (ID),
	CONSTRAINT FK_PERIODS2 FOREIGN KEY (PERIOD_ID) REFERENCES APP_DATOS_IMPRESION.PERIODS(ID)
);

-- Creando tabla que guarda inf sobre los archivos subidos

CREATE TABLE APP_DATOS_IMPRESION.UPLOADS (
	ID INTEGER GENERATED BY DEFAULT ON NULL AS IDENTITY START WITH 1 INCREMENT BY 1,
	LINK VARCHAR2(100) NOT NULL,
	CREATED VARCHAR2(100) NOT NULL,
	CONSTRAINT UPLOADS_PK PRIMARY KEY (ID)
);